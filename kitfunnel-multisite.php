<?php

/* 
 Plugin Name: KitFunnel
 Plugin URI: https://kitfunnel.com
 Description: PersonalizaciÃ³n Multisite
 Version: 1.2.3
 Author: KitFunnel
 Author URI: https://kitfunnel.com
 License: GPL 2+
 License URI: https://kitfunnel.com */ 



add_filter('contextual_help_list','asv_hide_help');function asv_hide_help(){global $current_screen;$current_screen->remove_help_tabs();}add_action('admin_bar_menu','bs_remove_nodes',999);function bs_remove_nodes(){global $wp_admin_bar;$wp_admin_bar->remove_node('comments');$wp_admin_bar->remove_node('wp-logo');$wp_admin_bar->remove_node('search');$wp_admin_bar->remove_node('updates');$wp_admin_bar->remove_node('themes');$wp_admin_bar->remove_node('customize');$wp_admin_bar->remove_node('widgets');$wp_admin_bar->remove_node('admin-cleaner-main');$wp_admin_bar->remove_node('archive');$wp_admin_bar->remove_node('edit-profile');$wp_admin_bar->remove_node('nfw_ntw1');$wp_admin_bar->remove_node('new-post');$wp_admin_bar->remove_node('new-page');}function wp_dashboard_hide_tw(){$screen=get_current_screen();if(!$screen){return;}remove_meta_box('dashboard_right_now','dashboard','normal');remove_meta_box('dashboard_primary','dashboard','side');remove_meta_box('e-dashboard-overview','dashboard','normal');remove_meta_box('woocommerce_dashboard_status','dashboard','normal');remove_action('welcome_panel','wp_welcome_panel');remove_meta_box('dashboard_site_health','dashboard','normal');remove_meta_box('nfw_dashboard_welcome','dashboard','normal');remove_meta_box('fluentsmtp_reports_widget','dashboard','normal');remove_meta_box('dashboard_quick_press','dashboard','side');}add_action('wp_dashboard_setup','wp_dashboard_hide_tw',20);function ocultar_todos_los_widgets_network_admin(){global $wp_meta_boxes;$page_slug='dashboard-network';if(isset($wp_meta_boxes[$page_slug])){$wp_meta_boxes[$page_slug]['normal']['core']=array();$wp_meta_boxes[$page_slug]['side']['core']=array();}function mi_widget_nfw_dashboard_welcome_content(){echo'<p>Te damos la bienvenida al panel de control principalðŸ‘‹. <br><br> Desde aquÃ­ puedes crear y gestionar tus sitios web, instalar y actualizar plugins, gestionar usuarios registrados y ajustar configuraciones globales para que todo funcione a la perfecciÃ³n.</p>';}$wp_meta_boxes[$page_slug]['normal']['core']['nfw_dashboard_welcome']=array('id'=>'nfw_dashboard_welcome','title'=>'Dashboard KitFunnel','callback'=>'mi_widget_nfw_dashboard_welcome_content',);}add_action('wp_network_dashboard_setup','ocultar_todos_los_widgets_network_admin');add_filter('allow_major_auto_core_updates','__return_false');function cleanup_attachment_link($link){return;}add_filter('attachment_link','cleanup_attachment_link');add_filter('run_wptexturize','__return_false');function myredirect_404(){if(is_404()){wp_redirect('/cn');exit;}}add_action('template_redirect','myredirect_404');function bbloomer_hide_admin_bar_if_non_admin($show){if(!current_user_can('administrator'))$show=false;return $show;}add_filter('show_admin_bar','bbloomer_hide_admin_bar_if_non_admin',20,1);function restrict_admin_area_by_rol(){if(!current_user_can('manage_options')&&(!defined('DOING_AJAX')||!DOING_AJAX)){wp_redirect(site_url());exit;}}add_action('admin_init','restrict_admin_area_by_rol',1);if(is_admin()){add_action('admin_menu','bs_remove_menu_items');function bs_remove_menu_items(){remove_menu_page('edit-comments.php');}function remove_menus(){remove_menu_page('wpcomplete-courses');remove_menu_page('jet-engine');remove_menu_page('jet-dashboard');remove_menu_page('astra');remove_menu_page('edit.php?post_type=bnfw_notification');remove_submenu_page('elementor','elementor-role-manager');remove_submenu_page('elementor','elementor-system-info');remove_submenu_page('elementor','elementor-getting-started');remove_submenu_page('elementor','e-form-submissions');remove_submenu_page('elementor','go_knowledge_base_site');remove_submenu_page('elementor','go_elementor_pro');remove_submenu_page('elementor','elementor-apps');remove_submenu_page('themes.php','themes.php');remove_submenu_page('themes.php','widgets.php');remove_submenu_page('themes.php','nav-menus.php');remove_submenu_page('themes.php','theme-editor.php');remove_submenu_page('tools.php','tools.php');remove_submenu_page('tools.php','import.php');remove_submenu_page('tools.php','export.php');remove_submenu_page('tools.php','export-personal-data.php');remove_submenu_page('tools.php','erase-personal-data.php');remove_submenu_page('tools.php','action-scheduler');remove_submenu_page('tools.php','site-health.php');remove_submenu_page('wmus','wmus-licence-verification');remove_submenu_page('NinjaFirewall','NinjaFirewall');remove_submenu_page('NinjaFirewall','nfsubmalwarescan');remove_submenu_page('NinjaFirewall','nfsubwplus');remove_submenu_page('options-general.php','options-writing.php');remove_submenu_page('options-general.php','options-media.php');remove_submenu_page('options-general.php','options-privacy.php');remove_submenu_page('options-general.php','options-discussion.php');remove_submenu_page('options-general.php','cpto-options');remove_submenu_page('options-general.php','ithemes-licensing');}add_action('admin_menu','remove_menus',999);}function ayudawp_desactiva_medios_adicionales_wp($sizes){unset($sizes['thumbnail']);unset($sizes['medium']);unset($sizes['large']);unset($sizes['medium_large']);unset($sizes['1536x1536']);unset($sizes['2048x2048']);return $sizes;}add_action('intermediate_image_sizes_advanced','ayudawp_desactiva_medios_adicionales_wp');add_filter('big_image_size_threshold','__return_false');function ayudawp_desactiva_otros_medios_adicionales(){remove_image_size('post-thumbnail');remove_image_size('otro-tamaÃ±o-adicional');}add_action('init','ayudawp_desactiva_otros_medios_adicionales');function hide_notices_dashboard(){global $wp_filter;$is_super_admin=is_super_admin();if(!$is_super_admin){if(is_network_admin()&&isset($wp_filter["network_admin_notices"])){unset($wp_filter['network_admin_notices']);}elseif(is_user_admin()&&isset($wp_filter["user_admin_notices"])){unset($wp_filter['user_admin_notices']);}else{if(isset($wp_filter["admin_notices"])){unset($wp_filter['admin_notices']);}}if(isset($wp_filter["all_admin_notices"])){unset($wp_filter['all_admin_notices']);}}}add_action('admin_init','hide_notices_dashboard');function disable_plugin_updates($value){unset($value->response['elementor/elementor.php']);unset($value->response['elementor-pro/elementor-pro.php']);unset($value->response['cartflows/cartflows.php']);unset($value->response['cartflows-pro/cartflows-pro.php']);unset($value->response['perfmatters/perfmatters.php']);unset($value->response['pixelyoursite-pro/pixelyoursite-pro.php']);unset($value->response['wp-fusion/wp-fusion.php']);unset($value->response['fluent-crm/fluent-crm.php']);unset($value->response['fluentcampaign-pro/fluentcampaign-pro.php']);return $value;}add_filter('site_transient_update_plugins','disable_plugin_updates');function insert_custom_script_in_footer(){if(current_user_can('manage_option')){ ?><script>window.addEventListener("load",function(){var t=document.querySelector("iframe"),e=t.contentDocument||t.contentWindow.document,n=document.createElement("style");n.textContent="#wpadminbar, .my-footer-tw {display: none!important;}  html{ margin: 0!important; }",e.head.appendChild(n)})</script><?php }}add_action('wp_footer','insert_custom_script_in_footer');



function css_personalizado_admin() { ?> <style>
		.wp-submenu.wp-submenu-wrap {border-radius: 6px !important;}.ab-sub-wrapper {border-radius: 0px 0px 6px 6px !important;}#wpadminbar ul.ab-sub-secondary {border-radius: 5px !important;}#wp-admin-bar-my-account img:not(#wp-admin-bar-user-info img) {border: 3px solid #8c8f94bf !important;border-radius: 6px !important;background: #aaaaaa00 !important;}#wp-admin-bar-user-info img {border-radius: 6px !important;}#adminmenu li.menu-top:hover {background-color: #fff0 !important;}#wp-admin-bar-my-sites-list .ab-sub-wrapper, #wp-admin-bar-my-sites-list .wp-admin-bar-arrow {display: none !important;}.e-notice--dismissible, .e-admin-top-bar__secondary-area {display: none !important;}.update-plugins {display: none !important;}#adminmenu #menu-posts {display: none !important;}#wp-admin-bar-blog-3 .ab-item::after {content: " CN" !important;}#wp-admin-bar-blog-4 .ab-item::after {content: " VN" !important;}#wp-admin-bar-blog-5 .ab-item::after {content: " CRM" !important;}#toplevel_page_beyond-multisite .wp-menu-image {visibility: hidden;}#toplevel_page_beyond-multisite .wp-menu-image:before {font-family: dashicons;content: '\f137';margin-left: 0.1px;font-size: 21px;display: inline-block;line-height: 0.9;visibility: visible;}#toplevel_page_NinjaFirewall .wp-menu-image img {display: none !important;}#toplevel_page_NinjaFirewall .wp-menu-image:before {content: '\f332';}.toplevel_page_ai1wm_export > div.wp-menu-image:before {background: none !important;}.toplevel_page_ai1wm_export > div.wp-menu-image:before {content: '\f321' !important;}#toplevel_page_ai1wm_export .wp-menu-name {visibility: hidden !important;font-size: 0px !important;}#toplevel_page_ai1wm_export .wp-menu-name::before {content: 'Respaldos' !important;visibility:visible !important;font-size: 14px !important;}.toplevel_page_pixelyoursite > .wp-menu-image img {display: none !important;}.toplevel_page_pixelyoursite > div.wp-menu-image:before {content: '\f150' !important;}.toplevel_page_pixelyoursite .col-3 {display: none !important;}.wp-has-submenu.toplevel_page_wmus {display: none !important;}.ai1wm-segment {display: none;}.ai1wm-row {margin-right: 0px;}.plugin-description p {height: 41px;display: block;display: -webkit-box;max-width: 100%;-webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;text-overflow: ellipsis;margin-bottom: 11px;}.update-message.notice.inline.notice-warning.notice-alt {display: none;}.cartflows-license-popup-open-button.inactive {display: none !important;}.plugins-php .row-actions {display: none !important;}.update-php.network-admin .button-primary:not(.update-from-upload-overwrite) {display: none !important;}.plugin-install-php.network-admin .activate-now {display: none !important;}.plugins-php.network-admin .activate {display: none !important;}.be-mu-network-enable-disable, .be-mu-bulk-activate-deactivate {display: none !important;}
</style> <?php } add_action( 'admin_head', 'css_personalizado_admin' ); ;



function css_personalizado_network() { if (is_network_admin()) { echo '<style>
		#toplevel_page_wppusher {display: none !important;}.toplevel_page_wppusher ul.wp-submenu.wp-submenu-wrap {display: none !important;}.toplevel_page_wppusher.wp-has-submenu.wp-not-current-submenu.opensub:hover:after {visibility: hidden !important;}.wp-pusher_page_wppusher-plugins h2, .wp-pusher_page_wppusher-themes h2, .wp-pusher_page_wppusher-plugins-create h2 {visibility: hidden !important;font-size: 0px !important;}table.wp-list-table.widefat.plugins img {width: 0px !important;margin-left: 0px !important;}.wp-pusher_page_wppusher-plugins .widefat, .wp-pusher_page_wppusher-themes .widefat {width: 100% !important;max-width: 550px !important;}.wp-pusher_page_wppusher-plugins .button-secondary, .wp-pusher_page_wppusher-themes .button-secondary {display: none !important;}.wp-pusher_page_wppusher-plugins .plugin-version-author-uri, .wp-pusher_page_wppusher-themes .plugin-version-author-uri {display: none !important;}.wp-pusher_page_wppusher-plugins .wppusher-ptd-show, .wp-pusher_page_wppusher-themes .wppusher-ptd-show {display: none !important;}.wp-pusher_page_wppusher-plugins td, .wp-pusher_page_wppusher-themes td {padding-bottom: 15px !important;}.wp-pusher_page_wppusher-plugins .fa.fa-github, .wp-pusher_page_wppusher-themes .fa.fa-github {margin-left: -18px !important;visibility: hidden !important;}.wp-pusher_page_wppusher-plugins hr, .wp-pusher_page_wppusher-themes hr {display: none !important;}.wp-pusher_page_wppusher-plugins #wpbody img, .wp-pusher_page_wppusher-themes #wpbody img, .wp-pusher_page_wppusher-plugins-create #wpbody img {display: none !important;}.wp-pusher_page_wppusher-plugins p, .wp-pusher_page_wppusher-themes p, .wp-pusher_page_wppusher-plugins-create p:not(.submit) {visibility: hidden !important;}.wp-pusher_page_wppusher-plugins .updated p, .wp-pusher_page_wppusher-plugins .error p, .wp-pusher_page_wppusher-themes .updated p, .wp-pusher_page_wppusher-themes .error p, .wp-pusher_page_wppusher-plugins-create .updated p, .wp-pusher_page_wppusher-plugins-create .error p {visibility: visible !important;}.wp-pusher_page_wppusher-plugins thead, .wp-pusher_page_wppusher-themes thead {display: none !important;}.wp-pusher_page_wppusher-plugins td, .wp-pusher_page_wppusher-themes td {padding-top: 15px !important;}.wp-pusher_page_wppusher-plugins-create h2::before {content: "Install Plugin" !important;font-size: 20px !important;font-weight: 500 !important;visibility: visible !important;}.wp-pusher_page_wppusher-plugins-create h2::after {content: "Agrega la ruta del plugin en el primer campo, escribe [main] en el segundo campo y, finalmente, haz clic en el botÃ³n [Install plugin].";font-size: 14px !important;visibility: visible !important;display: block !important;margin: 12px 0px 10px 0px !important;}.wp-pusher_page_wppusher-plugins-create #pick-from-gh-btn, .wp-pusher_page_wppusher-plugins-create .description, .wp-pusher_page_wppusher-plugins-create .form-table th, .wp-pusher_page_wppusher-plugins-create .form-table tr:nth-of-type(1), .wp-pusher_page_wppusher-plugins-create .form-table tr:nth-of-type(4), .wp-pusher_page_wppusher-plugins-create .form-table tr:nth-of-type(5), .wp-pusher_page_wppusher-plugins-create .form-table tr:nth-of-type(6) {display: none !important;}.wp-pusher_page_wppusher-plugins-create .form-table td {padding: 15px 0px !important;}.wp-pusher_page_wppusher-plugins-create .updated a {pointer-events: none !important;cursor: default !important;}.wp-pusher_page_wppusher-plugins-create .error p:nth-of-type(2), .wp-pusher_page_wppusher-plugins-create .error ul {display: none !important;}
</style>'; } } add_action('admin_head', 'css_personalizado_network');



add_action( 'wp_head', function () { ?> <style>
		.wp-submenu.wp-submenu-wrap {border-radius: 6px !important;}.ab-sub-wrapper {border-radius: 0px 0px 6px 6px !important;}#wpadminbar ul.ab-sub-secondary {border-radius: 5px !important;}#wp-admin-bar-my-account img:not(#wp-admin-bar-user-info img) {border: 3px solid #8c8f94bf !important;border-radius: 6px !important;background: #aaaaaa00 !important;}#wp-admin-bar-user-info img {border-radius: 6px !important;}#wp-admin-bar-my-sites-list .ab-sub-wrapper, #wp-admin-bar-my-sites-list .wp-admin-bar-arrow {display: none !important;}
</style> <?php } );